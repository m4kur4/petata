#### テストコードでエラー
- ダミーの画像ファイルを作成するコードでエラー

```
        Storage::fake('s3');

        $response = $this->actingAs($this->user)
            ->json('POST', route('photo.create'),[
                'photo' => UploadedFile::fake()->image('photo.jpg')
            ]);
```

```
Error: Call to undefined function Illuminate\Http\Testing\imagecreatetruecolor()
```
- `Dockerコンテナ内でIlluminate\Http\UploadedFileクラスを利用するには、PHP GD が必要な模様`
    - https://tanaken.me/web/770/  
    - https://qiita.com/Soh1121/items/17dcdc815a1d22f31788  
##### ※PHP7.4ではインストール方法が違う
https://uiuifree.com/blog/develop/docker-gd-php-7/

#### 非同期のPOSTで2回Submitが走る
- `type="button`を指定する  
    - https://teratail.com/questions/59493

#### Dockerコンテナの中で、急に`npm install`などが効かなくなる

```
root@e11dd10f07d4:/var/www/html# npm run dev
npm ERR! code ENOSYS
npm ERR! syscall read
npm ERR! errno -38
npm ERR! ENOSYS: function not implemented, read

npm ERR! A complete log of this run can be found in:
npm ERR!     /root/.npm/_logs/2020-08-06T08_36_06_323Z-debug.log
```
- docker再起動で直った
https://github.com/docker/for-win/issues/5955

#### Vuexのactions内でactionから別のactionを呼びだす
- NG(not function)
```js
    login(context, data) {
        const param = {
            context: context,
            data: data,
            uri: "api/user/auth/login",
            fnSuccess: () => {
                context.commit("setApiStatus", true);
                context.commit("setUser", response.data);
                return false;
            }
        };
        this.callApi(param);
    },
```
- dispatchで呼びだす
  - 第一引数には自動でcontextが入ってくるため、  
  引数をparam一つだけ設定しているとparamにcontextが入り、肝心のcontextが取得できない。
```js
    async login(context, data) {
        const param = {
            data: data,
            uri: "api/user/auth/login",
            fnSuccess: () => {
                context.commit("setApiStatus", true);
                context.commit("setUser", response.data);
                return false;
            }
        };
        await context.dispatch('callApi', param);
    },
    // .. 
    async callApi(context, param) {
        // ..
    }
```

#### computed内のget/setでアロー関数が使えない
- thisのスコープが変わってVueインスタンスの値をうまく参照できない模様。  
```js
    computed: {
        text: {
            get: () => {
                return this.value;
            },
            set: (value) => {
                this.$emit("input", value);
            }
        }
    }
```
- 従来の無名関数を使う
```js
    computed: {
        text: {
            get: function() {
                return this.value;
            },
            set: function(value) {
                this.$emit("input", 'hoge');
            }
        }
    }
```

### テストコード実行時にメモリが足りないというエラー
`Allowed memory size of 134217728 bytes exhausted (tried to allocate 9859   
  4816 bytes)`  
- php.iniの設定を変更(custom.ini)
```
memory_limit = 1024M
```

### 名前空間を定義したストアモジュールのmutationをコンポーネントから呼び出す
- stateが`this.$store.state.<mod>.<name>`なので、以下のようにしたがNG  
```
this.$store.<mod>.commit('hoge', val);
```
- ミューテーションやアクションの呼び出しは以下
```js
this.commit('module名/changeIsLogged', true);
this.$store.dispatch('module名/login');
```
#### 参考
https://qiita.com/kuriya/items/bc9a070119f0f4bfe944

### カスタムphp.iniを追加した後、PHPからDBへ接続できなくなった
-`driver could not found`
  - phpinfoのPDOからmysqlが消えている
- 再度PDOをインストールすると、conf.d直下に新しくphp.iniが作成された。  
ボリュームのマウント時に間違って上書きしていた？
```
docker-php-ext-install mysqli  pdo pdo_mysql 
```

### 共通コンポーネントの画像が一部のページだけで表示されない
- フォームタイトルのロゴがバインダー作成画面だけリンク切れになる  
当該imgタグは以下のように記述していた  
`<img class="header__logo-image" src="image/logo/logo_48_white.svg" width="42" height="42" alt="petata">`

- バインダー作成のパスは`binder/create`で、サインイン等のページより階層が一つ深い  
`image/logo`は相対パスで、「同じ階層のimageフォルダ」を参照する書き方
- 絶対パスである`/image/logo`へ修正して解決

### EagerLoadで`Call to a member function addEagerConstraints() on bool`
- 問題のコード
```php
$accesible_binders = Binder::query()
    ->with([
        'labels',
        'binderAuthorities',
        'binderFavorites',
        'isOwn',
        'isFavorite'
    ])
    ->whereIn('id', $accesible_binder_ids)
    ->get();
```

- with()の用途が間違っている。  
「リレーションを自動的にJSONへ含める」という関数なので、アクセサはここに記述しない
```php
$accesible_binders = Binder::with([
        'labels',
        'binderAuthorities',
        'binderFavorites',
        //不要：'isOwn',
        //不要：'isFavorite'
    ])
    ->whereIn('id', $accesible_binder_ids)
    ->get();
```
- アクセサは`$appends`に記述する
```php
protected $appends = [
    'isOwn',
    'isFavorite'
];
```
- 参考  
  - https://stackoverflow.com/questions/51254144/laravel-call-to-a-member-function-addeagerconstraints-on-boolean  
  - https://www.hypertextcandy.com/vue-laravel-tutorial-list-photos/

### アクセサで`Call to undefined method App\Models\Binder::getIsOwnAttribute()
- モデルに定義するメソッド名にはルールがある。`get〇〇Attribute`
- 参考  
https://qiita.com/shonansurvivors/items/cd7ee1c038f9543eab8f

### DropzoneのURLが思った通りにならない
#### http://localhost:8888/binder/detail/1で呼びだす
- 以下の記述だと`http://localhost:8888/binder/detail/api/image/add`になる。
```js
url: "api/image/add",
```
- こうすれば`http://localhost:8888/api/image/add`になった。
```js
// 先頭に"/"を付けた
url: "/api/image/add",
```